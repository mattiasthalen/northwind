- name: northwind__categories
  hooks:
  - name: _hook__category__id
    primary: true
    concept: category
    qualifier: id
    keyset: northwind.category.id
    expression: category_id

  - name: _hook__category__name
    primary: false
    concept: category
    qualifier: name
    keyset: northwind.category.name
    expression: category_name

  events:
    - name: category_record_updated_at
      source: dab.hook.northwind__categories
      join_on: _pit_hook__category__id
      expression: _record__updated_at

- name: northwind__customers
  hooks:
  - name: _hook__customer__id
    primary: true
    concept: customer
    qualifier: id
    keyset: northwind.customer.id
    expression: customer_id

  - name: _hook__customer__name
    primary: false
    concept: customer
    qualifier: name
    keyset: northwind.customer.name
    expression: company_name

  events:
    - name: customer_record_updated_at
      source: dab.hook.northwind__customers
      join_on: _pit_hook__customer__id
      expression: _record__updated_at

- name: northwind__employees
  hooks:
  - name: _hook__employee__id
    primary: true
    concept: employee
    qualifier: id
    keyset: northwind.employee.id
    expression: employee_id

  events:
    - name: employee_record_updated_at
      source: dab.hook.northwind__employees
      join_on: _pit_hook__employee__id
      expression: _record__updated_at

- name: northwind__employee_territories
  hooks:
  - name: _hook__employee__id
    primary: false
    concept: employee
    qualifier: id
    keyset: northwind.employee.id
    expression: employee_id

  - name: _hook__territory__id
    primary: false
    concept: territory
    qualifier: id
    keyset: northwind.territory.id
    expression: territory_id

  composite_hooks:
  - name: _hook__employee__territory
    primary: true
    hooks:
    - _hook__employee__id
    - _hook__territory__id

  events:
    - name: employee_territory_record_updated_at
      source: dab.hook.northwind__employee_territories
      join_on: _pit_hook__employee__territory
      expression: _record__updated_at

- name: northwind__orders
  hooks:
  - name: _hook__order__id
    primary: true
    concept: order
    qualifier: id
    keyset: northwind.order.id
    expression: order_id

  - name: _hook__customer__id
    primary: false
    concept: customer
    qualifier: id
    keyset: northwind.customer.id
    expression: customer_id

  - name: _hook__employee__id
    primary: false
    concept: employee
    qualifier: id
    keyset: northwind.employee.id
    expression: employee_id

  - name: _hook__shipper__id
    primary: false
    concept: shipper
    qualifier: id
    keyset: northwind.shipper.id
    expression: ship_via

  events:
    - name: order_placed_at
      source: dab.hook.northwind__orders
      join_on: _pit_hook__order__id
      expression: order_date

    - name: order_required_at
      source: dab.hook.northwind__orders
      join_on: _pit_hook__order__id
      expression: required_date

    - name: order_shipped_at
      source: dab.hook.northwind__orders
      join_on: _pit_hook__order__id
      expression: shipped_date

    - name: order_record_updated_at
      source: dab.hook.northwind__orders
      join_on: _pit_hook__order__id
      expression: _record__updated_at

- name: northwind__order_details
  hooks:
  - name: _hook__order__id
    primary: false
    concept: order
    qualifier: id
    keyset: northwind.order.id
    expression: order_id

  - name: _hook__product__id
    primary: false
    concept: product
    qualifier: id
    keyset: northwind.product.id
    expression: product_id

  composite_hooks:
  - name: _hook__order__product
    primary: true
    hooks:
    - _hook__order__id
    - _hook__product__id

  events:
    - name: product_ordered_at
      source: dab.hook.northwind__orders
      join_on: _pit_hook__order__id
      expression: order_date

    - name: product_required_at
      source: dab.hook.northwind__orders
      join_on: _pit_hook__order__id
      expression: required_date

    - name: product_shipped_at
      source: dab.hook.northwind__orders
      join_on: _pit_hook__order__id
      expression: shipped_date

    - name: order_detail_record_updated_at
      source: dab.hook.northwind__order_details
      join_on: _pit_hook__order__product
      expression: _record__updated_at

- name: northwind__products
  hooks:
  - name: _hook__product__id
    primary: true
    concept: product
    qualifier: id
    keyset: northwind.product.id
    expression: product_id

  - name: _hook__product__name
    primary: false
    concept: product
    qualifier: name
    keyset: northwind.product.name
    expression: product_name

  - name: _hook__supplier__id
    primary: false
    concept: supplier
    qualifier: id
    keyset: northwind.supplier.id
    expression: supplier_id

  - name: _hook__category__id
    primary: false
    concept: category
    qualifier: id
    keyset: northwind.category.id
    expression: category_id

  - name: _hook__category__detail
    primary: false
    concept: category
    qualifier: id
    keyset: northwind.category.id
    expression: category_id

  events:
    - name: product_record_updated_at
      source: dab.hook.northwind__products
      join_on: _pit_hook__product__id
      expression: _record__updated_at

- name: northwind__regions
  hooks:
  - name: _hook__region__id
    primary: true
    concept: region
    qualifier: id
    keyset: northwind.region.id
    expression: region_id

  - name: _hook__region__name
    primary: false
    concept: region
    qualifier: name
    keyset: northwind.region.name
    expression: region_description

  events:
    - name: region_record_updated_at
      source: dab.hook.northwind__regions
      join_on: _pit_hook__region__id
      expression: _record__updated_at

- name: northwind__shippers
  hooks:
  - name: _hook__shipper__id
    primary: true
    concept: shipper
    qualifier: id
    keyset: northwind.shipper.id
    expression: shipper_id

  - name: _hook__shipper__name
    primary: false
    concept: shipper
    qualifier: name
    keyset: northwind.shipper.name
    expression: company_name

  events:
    - name: shipper_record_updated_at
      source: dab.hook.northwind__shippers
      join_on: _pit_hook__shipper__id
      expression: _record__updated_at

- name: northwind__suppliers
  hooks:
  - name: _hook__supplier__id
    primary: true
    concept: supplier
    qualifier: id
    keyset: northwind.supplier.id
    expression: supplier_id

  - name: _hook__supplier__name
    primary: false
    concept: supplier
    qualifier: name
    keyset: northwind.supplier.name
    expression: company_name

  events:
    - name: supplier_record_updated_at
      source: dab.hook.northwind__suppliers
      join_on: _pit_hook__supplier__id
      expression: _record__updated_at

- name: northwind__territories
  hooks:
  - name: _hook__territory__id
    primary: true
    concept: territory
    qualifier: id
    keyset: northwind.territory.id
    expression: territory_id

  - name: _hook__territory__name
    primary: false
    concept: territory
    qualifier: name
    keyset: northwind.territory.name
    expression: territory_description

  - name: _hook__region__id
    primary: false
    concept: region
    qualifier: id
    keyset: northwind.region.id
    expression: region_id

  events:
    - name: territory_record_updated_at
      source: dab.hook.northwind__territories
      join_on: _pit_hook__territory__id
      expression: _record__updated_at